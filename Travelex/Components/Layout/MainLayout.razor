@inherits LayoutComponentBase
@inject NavigationManager NavigationManager

<div class="layout-container">
    <main class="main-content">
        @Body
    </main>

    @if (ShowBottomNav)
    {
        <nav class="bottom-nav">
            <NavLink class="nav-item" href="" Match="NavLinkMatch.All">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </NavLink>
            <NavLink class="nav-item" href="charts">
                <i class="fas fa-chart-bar"></i>
                <span>Charts</span>
            </NavLink>
            <NavLink class="nav-item" href="ai-summary">
                <i class="fas fa-robot"></i>
                <span>AI Summary</span>
            </NavLink>
            <NavLink class="nav-item" href="account">
                <i class="fas fa-user"></i>
                <span>Account</span>
            </NavLink>
        </nav>
    }
</div>

<style>
    /* 禁止页面回弹 */
    :global(html), :global(body) {
        position: fixed;
        width: 100%;
        height: 100%;
        overflow: hidden;
    }

    :global(#app) {
        width: 100%;
        height: 100%;
        overflow: hidden;
    }
    .layout-container {
        display: flex;
        flex-direction: column;
        height: 100%;
        position: relative;
        overflow: hidden;
        background-color: #f5f5f5;
        padding-bottom: 72px; /* 底部导航栏的高度 */
    }

    .main-content {
        flex: 1;
        width: 100%;
        height: 100%;
        overflow-y: auto;
        overscroll-behavior: none;
        -webkit-overflow-scrolling: touch;
        position: relative;
    }

    .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        display: flex;
        justify-content: space-around;
        align-items: center;
        background-color: #ffffff;
        height: 72px;
        box-shadow: 0 -1px 4px rgba(0, 0, 0, 0.1);
        border-radius: 20px 20px 0 0;
        z-index: 1000;
    }

    .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: #666666;
        text-decoration: none;
        transition: color 0.2s ease;
        width: 25%;
        height: 100%;
    }

    .nav-item:hover {
        color: #2196F3;
    }

    .nav-item.active {
        color: #2196F3;
    }

    .nav-item i {
        font-size: 1.25rem;
        margin-bottom: 2px;
    }

    .nav-item span {
        font-size: 0.75rem;
    }
</style>

@code {
    private bool ShowBottomNav = true;

    protected override void OnParametersSet()
    {
        var currentUri = NavigationManager.Uri;
        ShowBottomNav = !currentUri.Contains("login", StringComparison.OrdinalIgnoreCase);
    }
}